% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/LFPCA.R
\name{LFPCA}
\alias{LFPCA}
\title{Localized Functional Principal Component Analysis}
\usage{
LFPCA(
  data,
  Tmax,
  range,
  Nsel,
  smooth.data = TRUE,
  pve = 0.99,
  delta = 1,
  spar = 0.5,
  epsilon = 0.05,
  window_type = "cos",
  anp = "2"
)
}
\arguments{
\item{data}{A numeric matrix where rows are observations (curves) and
columns are time points.}

\item{Tmax}{Integer specifying the number of time points.}

\item{range}{Numeric vector of length 2 specifying the range of the time
domain, e.g., \code{c(0, 1)}.}

\item{Nsel}{Integer specifying the number of principal components to select.}

\item{smooth.data}{Logical indicating whether to smooth the data using
\code{\link[refund]{fpca.face}} before block detection. Default is
\code{TRUE}.}

\item{pve}{Numeric value between 0 and 1 specifying the proportion of
variance explained for the initial smoothing step. Default is 0.99.}

\item{delta}{Numeric value controlling the width of the window function
transition region. Default is 1.}

\item{spar}{Smoothing parameter passed to \code{\link[stats]{smooth.spline}}
for smoothing the tapered eigenfunctions. Default is 0.5.}

\item{epsilon}{Numeric threshold for minimum block size as a proportion of
total time points. Blocks smaller than \code{epsilon * Tmax} are ignored.
Default is 0.05.}

\item{window_type}{Character string specifying the window function type.
Either \code{"cos"} for cosine tapering or \code{"epan"} for Epanechnikov
kernel. Default is \code{"cos"}.}

\item{anp}{Character string passed to \code{\link[bdsvd]{bdsvd}} controlling
the regularization function used for the HBIC. Default is \code{"2"}.}
}
\value{
A list with four elements:
\describe{
\item{phi.df}{A data frame containing the smoothed eigenfunctions with columns:
\code{nr} (PC number as factor), \code{phi} (eigenfunction values),
\code{t} (time points), \code{Subprocess} (block number as factor),
and \code{eigenvalue}.}
\item{blocks}{A list of numeric vectors containing the time indices for
each detected block.}
\item{eigenvalues}{Numeric vector of the top \code{Nsel} eigenvalues in
decreasing order.}
\item{subprocess_numbers}{Integer vector indicating which block each of
the top eigenvalues came from.}
}
}
\description{
Performs Localized Functional Principal Component Analysis (LFPCA) by first
detecting block-diagonal structure in functional data, then computing
principal components within each localized block.
}
\details{
The LFPCA algorithm proceeds as follows:
\enumerate{
\item Optionally smooth the input data using FPCA FACE.
\item Detect block-diagonal structure using the bdSVD algorithm.
\item For each block larger than \code{epsilon * Tmax}, compute local
FPCA eigenfunctions.
\item Select the top \code{Nsel} eigenfunctions across all blocks based
on eigenvalue magnitude.
\item Apply window tapering and smoothing to create smooth, localized
eigenfunctions.
}
}
\examples{
\dontrun{
# Load the pinch force data
library(fda)
data(pinch)
X <- t(pinch)  # 301 time points x 24 curves

# Run LFPCA
result <- LFPCA(
  data = X,
  Tmax = ncol(X),
  range = c(1, ncol(X)),
  Nsel = 6,
  smooth.data = TRUE,
  window_type = "cos"
)

# Access the eigenfunctions
phi_df <- result[[1]]

# Access the eigenvalues
eigenvalues <- result[[3]]
}
}
\references{
For the bdsvd block detection method, see the \pkg{bdsvd} package.
For FACE FPCA, see the \pkg{refund} package.
}
